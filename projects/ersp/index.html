<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>ERSP Research | Michael Yang</title> <meta name="author" content="Michael Yang"> <meta name="description" content="detailing my Early Research Scholars Program work, image credited to Arthur Selle Jacobs, Roman Beltiukov"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://whugimy.github.io/projects/ersp/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Michael Yang</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/resume/">resume</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">ERSP Research</h1> <p class="post-description">detailing my Early Research Scholars Program work, image credited to Arthur Selle Jacobs, Roman Beltiukov</p> </header> <article> <p>I undertook a year-long (academic year) research project alongside Abel Atnafu, Luis Bravo, Aditi Phatak, and Emily Hu as part of the UCSB Early Research Scholars Program (ERSP). This research was a partnership with the UCSB Systems and Networking Lab, headed by Professor Arpit Gupta. Our research mentor was Roman Beltiukov, and the project we were working with was published by Arthur Selle Jacobs and Roman Beltiukov, titled <a href="https://sites.cs.ucsb.edu/~arpitgupta/pdfs/trustee.pdf" rel="external nofollow noopener" target="_blank">AI/ML for Network Security: The Emperor has no Clothes</a></p> <p>All of my technical work was done in Python, with heavy usage of <code class="language-plaintext highlighter-rouge">pandas</code> and <code class="language-plaintext highlighter-rouge">PyTorch</code> to load data and build/train my models. Also used a great deal of <code class="language-plaintext highlighter-rouge">sklearn</code> for tree-based models, and <code class="language-plaintext highlighter-rouge">matplotlib</code> for data visualization. We ended the project with a poster presentation at the UCSB CS department’s undergraduate research fair.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/projects/ersp/poster-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/projects/ersp/poster-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/projects/ersp/poster-1400.webp"></source> <img src="/assets/img/projects/ersp/poster.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Final Research Poster" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>You can view our final research poster in greater resolution <a href="https://docs.google.com/presentation/d/1V1tX5XgU97CPWW8AC1FKUjQi0PnCE7a0baB7sWcHmwM/edit?usp=sharing" rel="external nofollow noopener" target="_blank">here</a>. I recently got a new laptop and no longer have access to the server on which much of my code is stored. Once I go home and open that laptop, I will transfer more code over.</p> <h2 id="my-work-there-are-tldrs-throughout">My Work (There are TLDRs throughout)</h2> <h3 id="context">Context:</h3> <p>The networking space stands to benefit greatly from advances in machine learning and artificial intelligence. Network providers/operators receive and send tons of network data regularly, all of which needs to be safe. Naturally, you might think that AI could be applied as a way to classify network packets as safe or unsafe.</p> <p>There’s just one issue: most network operators don’t quite trust ML to manage their systems. Why?</p> <p>First, networking data used to train models is hard to access. Classification tasks require lots human-labeled data—labeling data. Labeling network data specifically requires a high level of expertise and is extremely time consuming.</p> <p>Also, lots of networking data is privately controlled by network operators, and for privacy and reasons they can’t release it to the public or for research.</p> <p>Therefore, many modern network datasets we might use to train models for network-related tasks are synthetic. But because these are technically not “real” data, they don’t always properly represent real-world network data flow. They might also be structured differently based on the devices involved, the experimenter’s decisions, etc.</p> <p>Also, industry standard machine learning models like neural networks (and even some non-deep learning models like random forests and gradient boosting) are what we call <a href="https://umdearborn.edu/news/ais-mysterious-black-box-problem-explained" rel="external nofollow noopener" target="_blank">black-box models</a>. We can’t directly access a black-box model’s logic to make sure it’s basing its decisions on the correct features.</p> <p>Consider a dataset built with a network of three devices, <code class="language-plaintext highlighter-rouge">A</code>, <code class="language-plaintext highlighter-rouge">B</code>, and <code class="language-plaintext highlighter-rouge">C</code>. We’ll send network packets from <code class="language-plaintext highlighter-rouge">A</code> and <code class="language-plaintext highlighter-rouge">B</code> to <code class="language-plaintext highlighter-rouge">C</code> to build the dataset. However, say we’ve designed <code class="language-plaintext highlighter-rouge">A</code> to send only normal network data, and <code class="language-plaintext highlighter-rouge">B</code> to send malicious data. In our dataset, if we have IP Address as a feature, the model will probably figure out that only <code class="language-plaintext highlighter-rouge">B</code> sends bad data. Therefore, under the hood, the model learns a shortcut: all data from <code class="language-plaintext highlighter-rouge">B</code> is labeled as malicious.</p> <p>In practice, this could be catastrophic. If we switch out <code class="language-plaintext highlighter-rouge">A</code> and <code class="language-plaintext highlighter-rouge">B</code> for new devices with different IP addresses, the model might not be able to differentiate between safe or bad packets anymore. Of course, there is the possibility that it still can, but technically we won’t ever know until we evaluate it on data out of the original training set (black-box model issue). But because not many datasets are available (and often different datasets are formatted differently), we might not have a proper testing set to look at (i.e. the testing set is still using <code class="language-plaintext highlighter-rouge">A</code> and <code class="language-plaintext highlighter-rouge">B</code>), and so we falsely believe our model is robust.</p> <p>This example seems fairly obvious to deal with in experimental setup, but similar issues like this can occur with any feature if we’re not careful. As the original paper shows, these issues absolutely <em>have happened</em>, and in large, recently published datasets as well.</p> <h4 id="tldr">TLDR</h4> <p>Networking tasks are good opportunity to apply ML (lots of data, high frequency). Networking datasets are hard to create due to cost and privacy, we rely on synthetic. Good ML models are black-box, with no observable logic. These combine to make ML models hard to analyze, hard to evaluate their quality. Network operators don’t like that, and therefore they don’t trust many black-box ML solutions.</p> <h3 id="solution">Solution</h3> <p>Thus, TRUSTEE, or TRUSt-oriented decision TreE Extraction comes into play. TRUSTEE was developed by Arthur Selle Jacobs and Roman Beltiukov (and others listed in the paper), and is a framework for training easily readable surrogate decision trees on black-box models. That way, we can find out about some of the decision-making process in the model without using extra data.</p> <p>I don’t explain decision trees, but you can read about them <a href="https://en.wikipedia.org/wiki/Decision_tree" rel="external nofollow noopener" target="_blank">here</a>.</p> <p>The specific TRUSTEE documentation is available <a href="https://trusteeml.github.io/" rel="external nofollow noopener" target="_blank">here</a>, but in general know that it can be used on any Python model object that has a <code class="language-plaintext highlighter-rouge">forward</code> and a <code class="language-plaintext highlighter-rouge">predict</code> method.</p> <p>The goal of the surrogate decision tree is to learn the decision-making process of the black-box model (to the best of the tree’s ability). If the fit is very accurate, we can <em>somewhat</em> assume that the black-box is making decisions based on what’s outlined in the tree.</p> <p>We then look at the top, most significant splits in the tree, and ensure that none of the features being used are problematic <a href="https://www.nature.com/articles/s42256-020-00257-z" rel="external nofollow noopener" target="_blank">shortcut features</a>. “Problematic” is extremely subjective to the dataset—what’s problematic about some feature in dataset A maybe not be in dataset B.</p> <p>That being said, my immediate question was, why bother with the black-box at all? If this architecture can fit decision trees to get similar results as compared to the black-box (which we’ll assume has fairly high accuracy), why spend the extra resources and time to train the black-box?</p> <p>Short answer (and what some of the research demonstrates), decision trees lack complexity. If the relationship between features and classification result is more complex than a DT can represent, they will oftentimes underfit. So, there are very likely cases where a neural network might outperform decision trees <em>significantly</em>, and there’s no way to fit a surrogate decision tree. This case applies much more often in vision and NLP problems, where decision trees are essentially unusuable compared to modern approaches.</p> <p>We tested boosting/bagging tree models, like <a href="https://xgboost.readthedocs.io/en/stable/" rel="external nofollow noopener" target="_blank">XGBoost</a> and <a href="https://en.wikipedia.org/wiki/Random_forest" rel="external nofollow noopener" target="_blank">Random Forests</a>, but I admittedly didn’t work much on tree-based black-box models, so I don’t have much to say about their performance with TRUSTEE.</p> <p>Back to NNs though—general intuition was that if the DT fits the NN really well, we might have an issue: there might be some really highly valued feature the NN is using as a shortcut that’s expressed as the top-few splits in the decision tree. We use the first DT splits (technically we display only the top-<code class="language-plaintext highlighter-rouge">k</code> decisions with some predefined <code class="language-plaintext highlighter-rouge">k</code>; Abel worked on tuning the default <code class="language-plaintext highlighter-rouge">k</code> value), because they split the most data points (DTs trained with entropy) and are the most likely candidates for shortcuts.</p> <p>Given these high impact features, we can then evaluate and see if they’re problematic. Because they’re network features though, it does require some networking expertise to determine how problematic they really are.</p> <p>If the DT doesn’t fit the NN at all, this framework isn’t really applicable anymore. TRUSTEE is good at immediately catching shortcuts if they’re there, but other types of black-box model issues can’t really be caught.</p> <h4 id="tldr-1">TLDR</h4> <p>TRUSTEE trains surrogate DTs on black-boxes. DTs are easily readable, and we use them to analyze the black-box models. NNs are more complex than DTs, and DTs often underfit in complex tasks that require NNs. So if the DT fits the NN really well, it might mean we have a couple highly valued features involved that we should look at. Overall, TRUSTEE provides good insights into model decision making, but the features should be analyzed by a networking expert for final evaluation.</p> <h3 id="conclusion">Conclusion</h3> <p>TODO</p> <p>TODO: add my code to repo and link, add proper citation below, maybe add some other research materials used</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Michael Yang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>